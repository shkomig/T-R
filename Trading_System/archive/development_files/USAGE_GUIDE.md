# 📊 Trading System - מדריך שימוש מלא

## 🎯 סיכום מהיר

### למה אין שינויים ב-P&L?

**3 סיבות:**
1. **אין מנוי Real-Time Data** - צריך לשלם ל-IB עבור נתונים חיים
2. **השוק סגור** - מסחר פעיל רק 9:30-16:00 EST
3. **אין אותות חדשים** - בלי נתונים חיים, האסטרטגיות לא מייצרות אותות

### הפוזיציות שרואים

הפוזיציות (JPN, MSFT, וכו') הן **פוזיציות קיימות** בחשבון ה-Paper Trading של IB Gateway.
הן לא נוצרו על ידי המערכת שלנו.

---

## 🚀 3 דרכים להריץ את המערכת

### 1️⃣ **CLI Dashboard** (מעקב בלבד)
```powershell
python dashboard\cli_dashboard.py
```
- ✅ מעקב real-time
- ✅ גרפים וטבלאות
- ❌ לא מבצע עסקאות חדשות
- שימוש: **מעקב על מצב המערכת**

### 2️⃣ **Live Auto Trading** (מסחר אוטומטי)
```powershell
python run_live_auto.py
```
- ✅ מבצע עסקאות **אוטומטית**
- ✅ מנטר את השוק 24/7
- ✅ מפעיל אסטרטגיות
- ⚠️ דורש שוק פתוח
- שימוש: **מסחר אוטומטי מלא**

### 3️⃣ **Backtest** (בדיקה היסטורית)
```powershell
python run_backtest.py
```
- ✅ בודק אסטרטגיות על נתונים עבר
- ✅ לא דורש חיבור live
- ✅ בטוח לחלוטין
- שימוש: **אופטימיזציה ובדיקות**

---

## 📡 מה צריך לעבוד?

### ✅ **מה שעובד עכשיו:**
- חיבור ל-IB Gateway ✅
- טעינת נתונים היסטוריים ✅
- אתחול אסטרטגיות ✅
- Dashboard עם refresh אוטומטי ✅
- מעקב אחר פוזיציות קיימות ✅

### ⚠️ **מה שלא עובד (ולמה):**
- **Real-time quotes** ❌
  - צריך: מנוי בתשלום ל-IB
  - שגיאה: "Error 420: No market data permissions"
  
- **מסחר חדש** ❌
  - סיבה 1: השוק סגור
  - סיבה 2: אין נתוני real-time
  - סיבה 3: אין אותות מהאסטרטגיות

---

## 🔧 כדי לראות פעילות אמיתית

### אפשרות 1: חכה לשוק פתוח
```
שעות מסחר: 9:30 - 16:00 EST
בישראל: 16:30 - 23:00
```

### אפשרות 2: הפעל במצב Auto
```powershell
# הפעל את המנוע האוטומטי
python run_live_auto.py

# בחלון אחר, הפעל את הדשבורד
python dashboard\cli_dashboard.py
```

### אפשרות 3: Backtest
```powershell
python run_backtest.py
```
זה יראה לך איך המערכת עובדת עם נתונים היסטוריים!

---

## 💡 שאלות נפוצות

### ❓ למה אני רואה פוזיציות אבל P&L=0?

**תשובה:** הפוזיציות האלה כבר קיימות בחשבון Paper Trading.
בלי נתוני real-time, המערכת לא יכולה לעדכן את המחיר הנוכחי ולחשב P&L.

### ❓ איך אני מבצע עסקאות?

**תשובה:** יש 3 דרכים:
1. **אוטומטי:** הרץ `run_live_auto.py` (המערכת מבצעת לבד)
2. **ידני דרך IB:** פתח TWS ועבוד שם
3. **Backtest:** בדוק אסטרטגיות על העבר

### ❓ מתי אני אראה פעילות?

**תשובה:** צריך 2 תנאים:
1. ✅ השוק פתוח (9:30-16:00 EST)
2. ✅ יש נתוני real-time (או Delayed Data)

### ❓ איך אני מקבל נתוני real-time?

**תשובה:** 
1. פתח חשבון IB אמיתי (לא סימולציה)
2. רכוש מנוי נתונים (US Equity: ~$1-2/חודש)
3. או השתמש ב-Delayed Data (15 דקות איחור, חינם)

---

## 🎮 מקשי קיצור בדשבורד

- `R` - Refresh ידני
- `S` - Start/Stop המנוע
- `Q` - יציאה
- `Ctrl+C` - עצירה מיידית

---

## 📞 בעיות נפוצות ופתרונות

### 🔴 "Error 420: No market data permissions"
**פתרון:** 
- זה תקין! אין מנוי
- אפשרות 1: רכוש מנוי
- אפשרות 2: הפעל Delayed Data ב-TWS
- אפשרות 3: התעלם והשתמש ב-Backtest

### 🔴 "clientId already in use"
**פתרון:**
```powershell
taskkill /F /IM python.exe
```

### 🔴 "Failed to initialize"
**פתרון:**
1. ודא ש-IB Gateway רץ
2. ודא Port 7497 פתוח
3. ודא "Enable API" מסומן ב-Gateway

---

## 🎯 סיכום - מה לעשות עכשיו?

### למעקב בלבד:
```powershell
python dashboard\cli_dashboard.py
# בחר אפשרות 1 (Connect)
# בחר אפשרות 2 (Live Dashboard)
```

### למסחר אוטומטי:
```powershell
python run_live_auto.py
# המתן לשוק פתוח
```

### לבדיקות:
```powershell
python run_backtest.py
```

---

**המערכת עובדת מצוין! 🎉**

הבעיה היחידה היא חוסר נתוני real-time, שזה מגבלה של IB Gateway (לא של המערכת שלנו).
